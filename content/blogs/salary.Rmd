---
categories:  
- "" #the front matter should be like the one found in, e.g., blog2.md. It cannot be like the normal Rmd we used
- ""
date: "2021-09-30"
description: Analysis of movie rentals # the title that will show up once someone gets to this page
draft: false
image: spices.jpg # save picture in \static\img\blogs. Acceptable formats= jpg, jpeg, or png . Your iPhone pics wont work

keywords: ""
slug: movies # slug is the shorthand URL address... no spaces plz
title: Analysis of movie rentals
---


```{r, setup, include=FALSE}
knitr::opts_chunk$set(
  message = FALSE, 
  warning = FALSE,
  tidy=FALSE, # display code as typed
  size="small") # slightly smaller font for code
options(digits = 3)

# default figure size
knitr::opts_chunk$set(
  fig.width=6.75, 
  fig.height=6.75,
  fig.align = "center"
)
```
```{r load-libraries, warning=FALSE, message=FALSE, echo=FALSE}
library(tidyverse)  # Load ggplot2, dplyr, and all the other tidyverse packages
library(mosaic)
library(ggthemes)
library(lubridate)
library(fivethirtyeight)
library(here)
library(skimr)
library(janitor)
library(vroom)
library(tidyquant)
library(rvest)
library(kableExtra)
library(ggrepel)
# to scrape wikipedia page
```
# Analysis of movies- IMDB dataset

We will look at a subset sample of movies, taken from the [Kaggle IMDB 5000 movie dataset](https://www.kaggle.com/carolzhangdc/imdb-5000-movie-dataset)

```{r,load_movies, warning=FALSE, message=FALSE}
movies <- read_csv(here::here("movies.csv"))
glimpse(movies)

```


## Extra Info
Besides the obvious variables of `title`, `genre`, `director`, `year`, and `duration`, the rest of the variables are as follows:

-   `gross` : The gross earnings in the US box office, not adjusted for inflation
-   `budget`: The movie's budget
-   `cast_facebook_likes`: the number of facebook likes cast members received
-   `votes`: the number of people who voted for (or rated) the movie in IMDB
-   `reviews`: the number of reviews for that movie
-   `rating`: IMDB average rating

## Relevant Questions:

-   Are there any missing values (NAs)? Are all entries distinct or are there duplicate entries?

```{r}
skimr::skim(movies) #To check for missing observations

glimpse(movies) #To check for duplicate values
```

There are no missing values. Not all entries are distinct, since there are duplicate entries for (for instance) the genre, year and director.


## Summary of Top Genres

```{r}
# Count movies by genre
movies %>%
    group_by(genres) %>%
    count(sort=TRUE) %>% 
    kable(format = "html")
   
```



## Gross Earnings and Return on Budget



```{r}
# Table with average gross earnings and budget
movies %>% 
  group_by(genre) %>% 
  summarise(average_gross_earning=mean(gross),
            average_budget=mean(budget)) %>%
  kable() %>% 
    kable_styling()

# Create new variable for return on budget  
movies <- movies %>%
  mutate(return_on_budget = gross/budget)

# Check new variable
glimpse(movies)

# Final table which shows return on budget, in descending order
movies %>% 
  group_by(genre) %>% 
  summarize(average_gross_earning=mean(gross),
            average_budget=mean(budget),
            average_return_on_budget=average_gross_earning/average_budget) %>% 
  arrange(desc(average_return_on_budget)) %>% 
  kable() %>% 
  kable_styling()
```

## Top Directors

```{r}
movies %>% 
  group_by(director) %>% 
  summarise(total_gross=sum(gross),
            mean_gross=mean(gross),
            median_gross=median(gross),
            sd_gross=sd(gross))%>% 
  arrange(desc(total_gross)) %>% 
  slice_max(order_by = total_gross, n=15) %>% # Top 15
  kable() %>% 
  kable_styling()
```

## Ratings Distribution

```{r}
# Table that contains mean, min, max, median and SD
movies %>% 
  group_by(genre) %>% 
  summarise(mean_rating=mean(rating),
            min_rating=min(rating),
            max_rating=max(rating),
            median_rating=median(rating),
            sd_rating=sd(rating)) %>% 
  arrange(desc(mean_rating)) %>% 
  kable() %>% 
  kable_styling()

# Density graph
ggplot(movies, aes(x = rating)) +
  geom_density() +
  labs(title = "Distribution of ratings", subtitle = "Density",
       x = "average IMDB rating",
       y = "Density") +
  facet_wrap(vars(genre))+
  NULL
```

## Do facebook likes affect Gross Revenue?


```{r, gross_on_fblikes}
ggplot(movies, aes(x = cast_facebook_likes, y = gross)) +
  geom_point()+
  labs(title= "Relationship between gross earnings and cast Facebook likes", subtitle="Scatterplot", x= "Number of Facebook likes that the cast has received", y="Gross earnings in the US box office, not adjusted for inflation")
```


Overall, it appears that there is no relationship between the number of Facebook likes that the cast has received and the gross earnings in the US box office, since there are many observations with few likes and low earnings, as well as few likes and high earnings.

## Does budget affect Gross Revenue?

```{r, gross_on_budget}
ggplot(movies, aes(x = budget, y = gross)) +
  geom_point()+
  labs(title= "Relationship between gross earnings and budget", subtitle="Scatterplot", x= "The movie budget", y="Gross earnings in the US box office, not adjusted for inflation")
```

Overall, it appears that there is a positive relationship between the movie budget and gross earnings in US box office.

## How are IMDB ratings and Gross Revenue related?

```{r, gross_on_rating}
ggplot(movies, aes(x = rating, y = gross)) +
  geom_point()+
  labs(title= "Relationship between IMDB rating and gross earnings by genre", subtitle="Scatterplot", x= "Average IMDB rating", y="Gross earnings in the US box office, not adjusted for inflation")+
  facet_wrap(vars(genre))
```


Overall, it appears that the relationship between IMDB rating and gross earnings in the US box office differ per genre. For action and adventure movies, for example, there appears to be a positive relationship between IMDB ratings and gross earnings. However, for documentaries and fantasy movies, there appears to be no relationship between IMDB ratings and gross earnings.

## Interesting observations

What is interesting to see in this dataset, is the fact that some genres have a significantly higher average gross earnings than other genres. For example, musicals tend to have significantly lower gross earnings than crime movies. This information could provide insights regarding consumer preferences for certain genres. Moreover, there are several genres with limited observations. For example, there is only one thriller movie and two western movies. As a result, no meaningful statistical conclusions can be drawn on the basis of these figures.